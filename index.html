<!DOCTYPE html>
<html>
<head>
    <title>漢字とタイプ</title>
    <audio src ="C:\Users\USER1\Downloads\Rocking Chair - Unicorn Heads.mp3" autoplay loop></audio>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="typing.css" />
    <audio src ="C:\Users\USER1\Downloads\猫の鳴き声1.mp3" id="missaudio"></audio>
    <audio src ="C:\Users\USER1\Downloads\猫の鳴き声1.mp3" id="correctaudio"></audio>
<script>
    var wordlist = 
    ["nakagawa",
    "memowotoru",
    "honyaniiku",
    "kotaewotou",
    "shiwokaku",
    "motinushi",
    "mattakukinishinai",
    "omotenideru",
    "tuginohinoasa",
    "yakunitatu",
    "ousama",
    "yousuwomiru",
    "zasshinohyoushi",
    "honnomokuzi",
    "iezinituku",
    "kaitenzushi",
    "ikenwoiu",
    "shouwatoheisei",
    "shokubutunoshiyou",
    "tizukigou",
    "shokuziwosuru",
    "zidoudoa",
    "toujouzinbutu",
    "toukousuru",
    "sakumotuwosodateru",
    "dourowohashiru",
    "senshuten",
    "ziyuukenkyuunosakuhin",
    "shihaturesshaninoru",
    "tegamidehentousuru",
    "itidokirinozinsei",
    "shugotojutugo",
    "suimennisakuhana",
    "hatumeikaninaru",
    "kurumanobuhin",
    "otoutonoshinchou",
    "yuuzintotozanniiku",
    "dekigoto",
    "nihondaihyousenshu",
    "bunshoumondai",
    "riri",
    "sachi"
    ];
    var wordlistJapanese = 
    ["中川",
    "メモを取る",
    "本屋に行く",
    "答えを問う",
    "詩を書く",
    "持ち主",
    "全く気にしない",
    "表に出る",
    "次の日の朝",
    "役に立つ",
    "王様",
    "様子を見る",
    "雑誌の表紙",
    "本の目次",
    "家路につく",
    "回転寿司",
    "意見を言う",
    "昭和と平成",
    "植物の子葉",
    "地図記号",
    "食事をする",
    "自動ドア",
    "登場人物",
    "登校する",
    "作物を育てる",
    "道路を走る",
    "先取点",
    "自由研究の作品",
    "始発列車に乗る",
    "手紙で返答する",
    "一度きりの人生",
    "主語と述語",
    "水面にさく花",
    "発明家になる",
    "車の部品",
    "弟の身長",
    "友人と登山に行く",
    "出来事",
    "日本代表選手",
    "文章問題",
    "凛々",
    "沙茅"];
    var time_limit = 90;
    var readytime = 3;
    var score;
    var correct;
    var mistake;
    var char_num = 0;
    var word_char;
    var random;
    var newline;
    var replacewordlist = [];
    function ready(){
        readytime = 3;
        scoredis.innerHTML="";
        start_button.style.visibility ="hidden";
        var readytimer = setInterval(function(){
            count.innerHTML=readytime;
            readytime--;
            if(readytime < 0){
               clearInterval(readytimer);
                gameStart();
            }
        },1000);
    }
    function gameStart(){
        score = 0.0;
        mistake = 0;
        correct = 0;
        wordDisplay();
        var time_remaining = time_limit;
        var gametimer = setInterval(function(){
            count.innerHTML="残り時間："+time_remaining;
            time_remaining--;
            if(time_remaining <= 0){
            clearInterval(gametimer);
                finish();
            }
        },1000);
    }
    function wordDisplay(){
        random = Math.floor( Math.random() * wordlist.length );
        replacewordlist[random] = wordlist[random].replace("<br>/g","");
        newline = wordlist[random].indexOf("<");
        word.innerHTML = wordlist[random];
        japanese.innerHTML = wordlistJapanese[random];
        charInsort();
    }
    function charInsort(){
        word_char = replacewordlist[random].charAt(char_num);
    }
    function finish(){
        score = ((correct*3) - mistake);
        // Math.floor(Math.pow(correct,2) * Math.pow((correct/(correct+mistake)),5));
        scoredis.innerHTML="スコア:"+score+"点"+"<hr>正タイプ数:"+correct+"<br>ミスタイプ数:"+mistake+"<br>正答率"+(correct/(correct+mistake)*100).toFixed(1)+"%";
        count.innerHTML="";
        word.innerHTML="";
        japanese.innerHTML="";
        start_button.style.visibility ="visible";
        word_char=0;
        random = 0;
        char_num = 0;
    }
document.onkeydown = function(e) {
    if(e.keyCode == 189){
       keyStr = "-";
       }else if(e.keyCode == 188){
                keyStr = ","
                }else{
                    var keyStr = String.fromCharCode(e.keyCode);
                    keyStr = keyStr.toLowerCase();
    }
    if(keyStr == word_char){
        document.getElementById('missaudio').pause();
        document.getElementById('missaudio').currentTime = 0;
        document.getElementById('correctaudio').pause();
        document.getElementById('correctaudio').currentTime = 0;
        document.getElementById('correctaudio').play();
        word.innerHTML="<span style='color: darkcyan;'>"+wordlist[random].substr(0,char_num+1)+"</span>"+wordlist[random].substr(char_num+1,wordlist[random].length);
        char_num++;
        if(newline == char_num){
           char_num = char_num + 4;
           }
        correct++;
        charInsort();
       }else{
           document.getElementById('missaudio').pause();
           document.getElementById('missaudio').currentTime = 0;
           document.getElementById('correctaudio').pause();
           document.getElementById('correctaudio').currentTime = 0;
           mistake++;
           document.getElementById('missaudio').play();
       }
    if(char_num == wordlist[random].length){
        char_num=0;
        wordDisplay();
       }
};
 
</script>
</head>
<body>
    <div class="wrap">
        <input type="button" 
        id="start_button" 
        value="開 始"
        style="margin:5px;
               font-size:30px;
               width:200px;
               height:70px;
               background-color: rgb(245, 88, 119);
               font-weight:900;
               color:white;" 
        onclick="ready()" 
        style="text-align:center"
        >
        <div id="count"></div>
        <h1><div id="japanese"></div></h1>
        <h2><div id="word"></div></h2>
        <div id="scoredis"></div>
    </div>
    
</body>
 
</html>
